/*!
 * MiniBar 0.1.10
 * http://mobius.ovh/
 *
 * Released under the MIT license
 */
!function(t){"use strict";function e(t,e,o){var n;return function(){var s=this,i=arguments,r=o&&!n;clearTimeout(n),n=setTimeout(function(){n=null,o||t.apply(s,i)},e),r&&t.apply(s,i)}}var o={barType:"default",minBarSize:10,alwaysShowBars:!1,containerClass:"mb-container",contentClass:"mb-content",trackClass:"mb-track",barClass:"mb-bar",visibleClass:"mb-visible",progressClass:"mb-progress",hoverClass:"mb-hover",scrollingClass:"mb-scrolling",textareaClass:"mb-textarea"},n=function(t,e){for(var o=Object(t),n=1;n<arguments.length;n++){var s=arguments[n];if(null!=s)for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(o[i]=s[i])}return o},s=function(t,e,o){t.addEventListener(e,o,!1)},i=function(t,e,o){t.removeEventListener(e,o)},r=function(t,e,o){if("[object Object]"===Object.prototype.toString.call(t))for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.call(o,n,t[n]);else for(var s=0,i=t.length;s<i;s++)e.call(o,s,t[s])},a=function(t,e,o){var n=t&&t.style,s="[object Object]"===Object.prototype.toString.call(e);if(n){if(!o&&!s)return window.getComputedStyle(t);s?r(e,function(t,e){t in n||(t="-webkit-"+t),n[t]=e+("string"==typeof e?"":"opacity"===t?"":"px")}):(e in n||(e="-webkit-"+e),n[e]=o+("string"==typeof o?"":"opacity"===e?"":"px"))}},c=function(t){var e=window,o=document,n=o.body,s=t.getBoundingClientRect(),i=void 0!==e.pageXOffset?e.pageXOffset:(o.documentElement||n.parentNode||n).scrollLeft,r=void 0!==e.pageYOffset?e.pageYOffset:(o.documentElement||n.parentNode||n).scrollTop;return{x:s.left+i,y:s.top+r,height:Math.round(s.height),width:Math.round(s.width)}},l=window.requestAnimationFrame||function(){var t=0;return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){var o,n=(new Date).getTime();return o=Math.max(0,16-(n-t)),t=n+o,setTimeout(function(){e(n+o)},o)}}(),d=function(t,e,o,n){return o*Math.sqrt(1-(t=t/n-1)*t)+e},u=function(){var t=0,e=document,o=e.createElement("div");return o.style.cssText="width: 100; height: 100; overflow: scroll; position: absolute; top: -9999;",e.body.appendChild(o),t=o.offsetWidth-o.clientWidth,e.body.removeChild(o),t},h=function(t,s){this.container="string"==typeof t?document.querySelector(t):t,this.config=n({},o,s||window.MiniBarOptions||{}),this.css=window.getComputedStyle(this.container),this.size=u(),this.textarea="textarea"===this.container.nodeName.toLowerCase(),this.bars={x:{},y:{}},this.tracks={x:{},y:{}},this.trackPos={x:"left",y:"top"},this.trackSize={x:"width",y:"height"},this.scrollPos={x:"scrollLeft",y:"scrollTop"},this.scrollSize={x:"scrollWidth",y:"scrollHeight"},this.mouseAxis={x:"pageX",y:"pageY"},this.events={},r(["update","scroll","mouseenter","mousedown","mousemove","mouseup","mousewheel"],function(t,e){this.events[e]=this[e].bind(this)},this),this.events.debounce=e(this.events.update,50),this.init()},m=h.prototype;m.init=function(){var t=this;if(!t.initialised){if(t.textarea)t.content=t.container,t.container=document.createElement("div"),t.container.classList.add(t.config.textareaClass),t.content.parentNode.insertBefore(t.container,t.content),t.container.appendChild(t.content),s(t.content,"input",function(e){t.update()});else for(t.content=document.createElement("div");t.container.firstChild;)t.content.appendChild(t.container.firstChild);t.container.classList.add(t.config.containerClass),t.content.classList.add(t.config.contentClass),t.config.alwaysShowBars&&t.container.classList.add(t.config.visibleClass),r(t.tracks,function(e,o){t.bars[e].node=document.createElement("div"),o.node=document.createElement("div"),o.node.classList.add(t.config.trackClass),o.node.classList.add(t.config.trackClass+"-"+e),t.bars[e].node.classList.add(t.config.barClass),o.node.appendChild(t.bars[e].node),t.container.appendChild(o.node),"progress"===t.config.barType?(o.node.classList.add(t.config.progressClass),s(o.node,"mousedown",t.events.mousedown)):s(t.bars[e].node,"mousedown",t.events.mousedown),s(o.node,"mouseenter",function(o){t.container.classList.add(t.config.hoverClass+"-"+e)}),s(o.node,"mouseleave",function(o){t.down||t.container.classList.remove(t.config.hoverClass+"-"+e)})}),t.container.appendChild(t.content),"static"===t.css.position&&(t.manualPosition=!0,t.container.style.position="relative"),t.update(),s(t.content,"scroll",t.events.scroll),s(t.content,"wheel",t.events.mousewheel),s(t.container,"mouseenter",t.events.mouseenter),s(window,"resize",t.events.debounce),s(document,"DOMContentLoaded",t.events.update),s(window,"load",t.events.update),t.initialised=!0}},m.scroll=function(t){this.updateScrollBars()},m.mousewheel=function(t){if(this.config.horizontalMouseScroll){t.preventDefault();var e=this,o=t.deltaY,n=Date.now(),s=function(){var t=Date.now()-n,i=d(t,0,8,400);t>400?cancelAnimationFrame(e.frame):(o<0?e.content.scrollLeft-=i:o>0&&(e.content.scrollLeft+=i),e.frame=l(s))};s()}},m.mouseenter=function(t){this.updateScrollBars()},m.mousedown=function(t){t.preventDefault(),this.down=!0;var e=this.config,o="progress"===e.barType?"tracks":"bars",n=t.target===this[o].x.node?"x":"y";this.currentAxis=n,this.update(),this.container.classList.add(e.visibleClass),this.container.classList.add(e.scrollingClass+"-"+n),"progress"===e.barType?(this.origin={x:t.pageX-this.tracks[n].x,y:t.pageY-this.tracks[n].y},this.mousemove(t)):this.origin={x:t.pageX-this.bars[n].x,y:t.pageY-this.bars[n].y},s(document,"mousemove",this.events.mousemove),s(document,"mouseup",this.events.mouseup)},m.mousemove=function(t){t.preventDefault();var e,o,n=this,s=this.origin,i=this.currentAxis,r=n.tracks[i],a=r[n.trackSize[i]],c=n.rect[n.trackSize[i]];"progress"===n.config.barType?(e=t[n.mouseAxis[i]]-r[i],o=e/a*(n.content[n.scrollSize[i]]-c)):(e=t[n.mouseAxis[i]]-s[i]-r[i],o=e/a*n[n.scrollSize[i]]),l(function(){n.content[n.scrollPos[i]]=o})},m.mouseup=function(t){var e=this.container.classList,o=this.config,n=this.events;e.toggle(o.visibleClass,o.alwaysShowBars),e.remove(o.scrollingClass+"-"+this.currentAxis),t.target.classList.contains(o.barClass)||(e.remove(o.hoverClass+"-x"),e.remove(o.hoverClass+"-y")),this.origin={},this.currentAxis=null,this.down=!1,i(document,"mousemove",n.mousemove),i(document,"mouseup",n.mouseup)},m.update=function(){var t=this,e=t.content;t.rect=c(t.container),t.scrollTop=e.scrollTop,t.scrollLeft=e.scrollLeft,t.scrollHeight=e.scrollHeight,t.scrollWidth=e.scrollWidth;var o=t.scrollWidth>t.rect.width&&!t.textarea,s=t.scrollHeight>t.rect.height;t.container.classList.toggle("mb-scroll-x",o),t.container.classList.toggle("mb-scroll-y",s),a(e,{overflow:"auto",marginBottom:o?-t.size:"",paddingBottom:o?t.size:"",marginRight:s?-t.size:"",paddingRight:s?t.size:""}),t.scrollX=o,t.scrollY=s,r(t.tracks,function(e,o){n(o,c(o.node)),n(t.bars[e],c(t.bars[e].node))}),t.updateScrollBars(),t.textarea&&!t.down&&e.selectionStart>=e.value.length&&(e.scrollTop=t.scrollHeight+1e3)},m.updateScrollBar=function(t){var e=this,o={},n=e.tracks[t][e.trackSize[t]],s=e.rect[e.trackSize[t]],i=e.content[e.scrollPos[t]],r=n/e[e.scrollSize[t]],c=i/(e[e.scrollSize[t]]-s);"progress"===e.config.barType?o[e.trackSize[t]]=Math.floor(n*c):(o[e.trackSize[t]]=Math.max(Math.floor(r*s),e.config.minBarSize),o[e.trackPos[t]]=Math.floor((n-o[e.trackSize[t]])*c)),l(function(){a(e.bars[t].node,o)})},m.updateScrollBars=function(){r(this.bars,function(t,e){this.updateScrollBar(t)},this)},m.destroy=function(){var t=this,e=this.container;if(t.initialised){for(i(e,"mouseenter",t.events.mouseenter),i(window,"resize",t.events.debounce),e.classList.remove(t.config.visibleClass),e.classList.remove(t.config.containerClass);t.content.firstChild;)e.appendChild(t.content.firstChild);r(t.tracks,function(t,o){e.removeChild(o.node),e.classList.remove("mb-scroll-"+t)}),e.removeChild(t.content),t.manualPosition&&(e.style.position="",null!==e.getAttribute("style")&&e.getAttribute("style").length||e.removeAttribute("style")),t.bars={x:{},y:{}},t.tracks={x:{},y:{}},t.content=null,t.initialised=!1}},t.MiniBar=h}(this);