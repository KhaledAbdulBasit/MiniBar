/*!
 * MiniBar 0.2.1
 * http://mobius.ovh/
 *
 * Released under the MIT license
 */
!function(e){"use strict";function t(e,t,n){var o;return function(){var a=this,s=arguments,r=n&&!o;clearTimeout(o),o=setTimeout(function(){o=null,n||e.apply(a,s)},t),r&&e.apply(a,s)}}var n=window,o=document,a=o.body,s={x:"left",y:"top"},r={x:"width",y:"height"},i={x:"scrollLeft",y:"scrollTop"},c={x:"scrollWidth",y:"scrollHeight"},l={x:"pageX",y:"pageY"},d={barType:"default",minBarSize:10,alwaysShowBars:!1,horizontalMouseScroll:!1,scrollX:!0,scrollY:!0,navButtons:!1,scrollAmount:10,containerClass:"mb-container",contentClass:"mb-content",trackClass:"mb-track",barClass:"mb-bar",visibleClass:"mb-visible",progressClass:"mb-progress",hoverClass:"mb-hover",scrollingClass:"mb-scrolling",textareaClass:"mb-textarea",wrapperClass:"mb-wrapper",navClass:"mb-nav",btnClass:"mb-button",btnsClass:"mb-buttons",increaseClass:"mb-increase",decreaseClass:"mb-decrease"},u=function(e,t){for(var n=Object(e),o=1;o<arguments.length;o++){var a=arguments[o];if(null!=a)for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])}return n},p=function(e,t,n){e.addEventListener(t,n,!1)},m=function(e,t,n){e.removeEventListener(t,n)},h=function(e,t,n){if("[object Object]"===Object.prototype.toString.call(e))for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(n,o,e[o]);else for(var a=0,s=e.length;a<s;a++)t.call(n,a,e[a])},f=function(e,t){var o=e&&e.style,a="[object Object]"===Object.prototype.toString.call(t);if(o){if(!t)return n.getComputedStyle(e);a&&h(t,function(e,t){e in o||(e="-webkit-"+e),o[e]=t+("string"==typeof t?"":"opacity"===e?"":"px")})}},v=function(e){var t=n,s=e.getBoundingClientRect(),r=o.documentElement||a.parentNode||a,i=void 0!==t.pageXOffset?t.pageXOffset:r.scrollLeft,c=void 0!==t.pageYOffset?t.pageYOffset:r.scrollTop;return{x:s.left+i,y:s.top+c,height:Math.round(s.height),width:Math.round(s.width)}},g=n.requestAnimationFrame||function(){var e=0;return n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||function(t){var n,o=(new Date).getTime();return n=Math.max(0,16-(o-e)),e=o+n,setTimeout(function(){t(o+n)},n)}}(),b=function(){var e=0,t=o.createElement("div");return t.style.cssText="width: 100; height: 100; overflow: scroll; position: absolute; top: -9999;",o.body.appendChild(t),e=t.offsetWidth-t.clientWidth,o.body.removeChild(t),e},C={contains:function(e,t){if(e)return e.classList?e.classList.contains(t):!!e.className&&!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},add:function(e,t){C.contains(e,t)||(e.classList?e.classList.add(t):e.className=e.className.trim()+" "+t)},remove:function(e,t){C.contains(e,t)&&(e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\s)"+t.split(" ").join("|")+"(\\s|$)","gi")," "))},toggle:function(e,t,n){var o=this.contains(e,t)?!0!==n&&"remove":!1!==n&&"add";o&&this[o](e,t)}},w=function(e,a){this.container="string"==typeof e?o.querySelector(e):e,this.config=d,a?this.config=u({},d,a):n.MiniBarOptions&&(this.config=u({},d,n.MiniBarOptions)),this.css=n.getComputedStyle(this.container),this.size=b(),this.textarea="textarea"===this.container.nodeName.toLowerCase(),this.bars={x:{},y:{}},this.tracks={x:{},y:{}},this.events={},h(["update","scroll","mouseenter","mousedown","mousemove","mouseup","wheel"],function(e,t){this.events[t]=this[t].bind(this)},this),this.events.debounce=t(this.events.update,50),this.init()},y=w.prototype;y.init=function(){var e=this,t=e.config,a=e.events;if(!e.initialised){if(e.textarea)e.content=e.container,e.container=o.createElement("div"),C.add(e.container,t.textareaClass),e.wrapper=o.createElement("div"),C.add(e.wrapper,t.wrapperClass),e.container.appendChild(e.wrapper),e.content.parentNode.insertBefore(e.container,e.content),e.content.addEventListener("input",function(t){e.update()});else for(e.content=o.createElement("div");e.container.firstChild;)e.content.appendChild(e.container.firstChild);C.add(e.container,t.containerClass),C.add(e.content,t.contentClass),t.alwaysShowBars&&C.add(e.container,t.visibleClass),h(e.tracks,function(n,s){if(e.bars[n].node=o.createElement("div"),s.node=o.createElement("div"),C.add(s.node,t.trackClass),C.add(s.node,t.trackClass+"-"+n),C.add(e.bars[n].node,t.barClass),s.node.appendChild(e.bars[n].node),t.navButtons){var r=o.createElement("button"),c=o.createElement("button"),l=o.createElement("div"),d=t.scrollAmount;r.className=t.btnClass+" "+t.decreaseClass,c.className=t.btnClass+" "+t.increaseClass,l.className=t.btnsClass+" "+t.btnsClass+"-"+n,l.appendChild(r),l.appendChild(s.node),l.appendChild(c),e.container.appendChild(l),C.add(e.container,t.navClass),p(l,"mousedown",function(t){var o=t.target;if(cancelAnimationFrame(e.frame),o===c||o===r){var a=e.content[i[n]],s=function(t){switch(e.content[i[n]]=a,o){case r:a-=d;break;case c:a+=d}e.frame=g(s)};s()}}),p(l,"mouseup",function(t){var o=t.target,a=5*d;cancelAnimationFrame(e.frame),o!==c&&o!==r||e.scrollBy(o===r?-a:a,n)})}else e.container.appendChild(s.node);"progress"===t.barType?(C.add(s.node,t.progressClass),p(s.node,"mousedown",a.mousedown)):p(e.bars[n].node,"mousedown",a.mousedown),p(s.node,"mouseenter",function(o){C.add(e.container,t.hoverClass+"-"+n)}),p(s.node,"mouseleave",function(o){e.down||C.remove(e.container,t.hoverClass+"-"+n)})}),e.textarea?e.wrapper.appendChild(e.content):e.container.appendChild(e.content),"static"===e.css.position&&(e.manualPosition=!0,e.container.style.position="relative"),e.update(),p(e.content,"scroll",a.scroll),p(e.container,"mouseenter",a.mouseenter),t.horizontalMouseScroll&&p(e.content,"wheel",a.wheel),p(n,"resize",a.debounce),p(o,"DOMContentLoaded",a.update),p(n,"load",a.update),e.initialised=!0}},y.scroll=function(e){this.updateBars()},y.scrollBy=function(e,t,n,o){if(t=t||"y",0!==n){void 0===n&&(n=250),o=o||function(e,t,n,o){return e/=o,-n*e*(e-2)+t};var a=this,s=Date.now(),r=a.content[i[t]],c=function(){var l=Date.now()-s;l>n?cancelAnimationFrame(a.frame):(a.content[i[t]]=o(l,r,e,n),a.frame=g(c))};c()}else this.content[i[t]]+=e},y.wheel=function(e){e.preventDefault(),this.scrollBy(100*e.deltaY,"x")},y.mouseenter=function(e){this.updateBars()},y.mousedown=function(e){e.preventDefault(),this.down=!0;var t=this,n=t.config,a="progress"===n.barType?"tracks":"bars",s=e.target===t[a].x.node?"x":"y";t.currentAxis=s,t.update(),C.add(t.container,n.visibleClass),C.add(t.container,n.scrollingClass+"-"+s),"progress"===n.barType?(t.origin={x:e.pageX-t.tracks[s].x,y:e.pageY-t.tracks[s].y},t.mousemove(e)):t.origin={x:e.pageX-t.bars[s].x,y:e.pageY-t.bars[s].y},p(o,"mousemove",t.events.mousemove),p(o,"mouseup",t.events.mouseup)},y.mousemove=function(e){e.preventDefault();var t,n,o=this,a=this.origin,s=this.currentAxis,d=o.tracks[s],u=d[r[s]];"progress"===o.config.barType?(t=e[l[s]]-d[s],n=t/u*(o.content[c[s]]-o.rect[r[s]])):(t=e[l[s]]-a[s]-d[s],n=t/u*o[c[s]]),g(function(){o.content[i[s]]=n})},y.mouseup=function(e){var t=this,n=t.config,a=t.events;C.toggle(t.container,n.visibleClass,n.alwaysShowBars),C.remove(t.container,n.scrollingClass+"-"+t.currentAxis),C.contains(e.target,n.barClass)||(C.remove(t.container,n.hoverClass+"-x"),C.remove(t.container,n.hoverClass+"-y")),t.currentAxis=null,t.down=!1,m(o,"mousemove",a.mousemove),m(o,"mouseup",a.mouseup)},y.update=function(){var e=this,t=e.config,n=e.content,o=e.size;e.rect=v(e.container),e.scrollTop=n.scrollTop,e.scrollLeft=n.scrollLeft,e.scrollHeight=n.scrollHeight,e.scrollWidth=n.scrollWidth;var a=e.scrollWidth>e.rect.width&&!e.textarea,s=e.scrollHeight>e.rect.height;if(C.toggle(e.container,"mb-scroll-x",a&&t.scrollX),C.toggle(e.container,"mb-scroll-y",s&&t.scrollY),f(n,{overflowX:a?"auto":"",overflowY:s?"auto":"",marginBottom:a?-o:"",paddingBottom:a?o:"",marginRight:s?-o:"",paddingRight:s?o:""}),e.scrollX=a,e.scrollY=s,h(e.tracks,function(t,n){u(n,v(n.node)),u(e.bars[t],v(e.bars[t].node))}),e.updateBars(),e.wrapperPadding=0,e.textarea){var r=f(e.wrapper);e.wrapperPadding=parseInt(r.paddingTop,10)+parseInt(r.paddingBottom,10),!e.down&&e.content.selectionStart>=e.content.value.length&&(e.content.scrollTop=e.scrollHeight+1e3)}},y.updateBar=function(e){var t=this,n={},o=r,a=c,l=t.config,d=t.tracks[e][o[e]],u=t.rect[o[e]]-t.wrapperPadding,p=t.content[i[e]],m=d/t[a[e]],h=p/(t[a[e]]-u);"progress"===l.barType?n[o[e]]=Math.floor(d*h):(n[o[e]]=Math.max(Math.floor(m*u),l.minBarSize),n[s[e]]=Math.floor((d-n[o[e]])*h)),g(function(){f(t.bars[e].node,n)})},y.updateBars=function(){h(this.bars,function(e,t){this.updateBar(e)},this)},y.destroy=function(){var e=this,t=e.config,o=e.container;if(e.initialised){for(m(o,"mouseenter",e.events.mouseenter),m(n,"resize",e.events.debounce),C.remove(o,t.visibleClass),C.remove(o,t.containerClass),C.remove(o,t.navClass),h(e.tracks,function(e,n){o.removeChild(t.navButtons?n.node.parentNode:n.node),C.remove(o,"mb-scroll-"+e)});e.content.firstChild;)o.appendChild(e.content.firstChild);o.removeChild(e.content),e.manualPosition&&(o.style.position=""),e.bars={x:{},y:{}},e.tracks={x:{},y:{}},e.content=null,e.initialised=!1}},e.MiniBar=w}(this);