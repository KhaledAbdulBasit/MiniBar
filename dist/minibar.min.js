/*!
 * MiniBar 0.1.10
 * http://mobius.ovh/
 *
 * Released under the MIT license
 */
!function(e){"use strict";function t(e,t,n){var o;return function(){var s=this,i=arguments,r=n&&!o;clearTimeout(o),o=setTimeout(function(){o=null,n||e.apply(s,i)},t),r&&e.apply(s,i)}}var n=window,o=document,s=o.body,i={x:"left",y:"top"},r={x:"width",y:"height"},a={x:"scrollLeft",y:"scrollTop"},c={x:"scrollWidth",y:"scrollHeight"},l={x:"pageX",y:"pageY"},d={barType:"default",minBarSize:10,alwaysShowBars:!1,containerClass:"mb-container",contentClass:"mb-content",trackClass:"mb-track",barClass:"mb-bar",visibleClass:"mb-visible",progressClass:"mb-progress",hoverClass:"mb-hover",scrollingClass:"mb-scrolling",textareaClass:"mb-textarea"},u=function(e,t){for(var n=Object(e),o=1;o<arguments.length;o++){var s=arguments[o];if(null!=s)for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i])}return n},h=function(e,t,n){e.addEventListener(t,n,!1)},f=function(e,t,n){e.removeEventListener(t,n)},p=function(e,t,n){if("[object Object]"===Object.prototype.toString.call(e))for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(n,o,e[o]);else for(var s=0,i=e.length;s<i;s++)t.call(n,s,e[s])},m=function(e,t){var o=e&&e.style,s="[object Object]"===Object.prototype.toString.call(t);if(o){if(!t)return n.getComputedStyle(e);s&&p(t,function(e,t){e in o||(e="-webkit-"+e),o[e]=t+("string"==typeof t?"":"opacity"===e?"":"px")})}},v=function(e){var t=n,i=e.getBoundingClientRect(),r=void 0!==t.pageXOffset?t.pageXOffset:(o.documentElement||s.parentNode||s).scrollLeft,a=void 0!==t.pageYOffset?t.pageYOffset:(o.documentElement||s.parentNode||s).scrollTop;return{x:i.left+r,y:i.top+a,height:Math.round(i.height),width:Math.round(i.width)}},g=n.requestAnimationFrame||function(){var e=0;return n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||function(t){var n,o=(new Date).getTime();return n=Math.max(0,16-(o-e)),e=o+n,setTimeout(function(){t(o+n)},n)}}(),b=function(e,t,n,o){return n*Math.sqrt(1-(e=e/o-1)*e)+t},y=function(){var e=0,t=o.createElement("div");return t.style.cssText="width: 100; height: 100; overflow: scroll; position: absolute; top: -9999;",o.body.appendChild(t),e=t.offsetWidth-t.clientWidth,o.body.removeChild(t),e},C=function(e,s){var i=this;i.container="string"==typeof e?o.querySelector(e):e,i.config=u({},d,s||n.MiniBarOptions||{}),i.css=n.getComputedStyle(i.container),i.size=y(),i.textarea="textarea"===i.container.nodeName.toLowerCase(),i.bars={x:{},y:{}},i.tracks={x:{},y:{}},i.events={},p(["update","scroll","mouseenter","mousedown","mousemove","mouseup","mousewheel"],function(e,t){i.events[t]=i[t].bind(i)},i),i.events.debounce=t(i.events.update,50),i.init()},w=C.prototype;w.init=function(){var e=this;if(!e.initialised){if(e.textarea)e.content=e.container,e.container=o.createElement("div"),e.container.classList.add(e.config.textareaClass),e.content.parentNode.insertBefore(e.container,e.content),e.container.appendChild(e.content),h(e.content,"input",function(t){e.update()});else for(e.content=o.createElement("div");e.container.firstChild;)e.content.appendChild(e.container.firstChild);e.container.classList.add(e.config.containerClass),e.content.classList.add(e.config.contentClass),e.config.alwaysShowBars&&e.container.classList.add(e.config.visibleClass),p(e.tracks,function(t,n){e.bars[t].node=o.createElement("div"),n.node=o.createElement("div"),n.node.classList.add(e.config.trackClass),n.node.classList.add(e.config.trackClass+"-"+t),e.bars[t].node.classList.add(e.config.barClass),n.node.appendChild(e.bars[t].node),e.container.appendChild(n.node),"progress"===e.config.barType?(n.node.classList.add(e.config.progressClass),h(n.node,"mousedown",e.events.mousedown)):h(e.bars[t].node,"mousedown",e.events.mousedown),h(n.node,"mouseenter",function(n){e.container.classList.add(e.config.hoverClass+"-"+t)}),h(n.node,"mouseleave",function(n){e.down||e.container.classList.remove(e.config.hoverClass+"-"+t)})}),e.container.appendChild(e.content),"static"===e.css.position&&(e.manualPosition=!0,e.container.style.position="relative"),e.update(),h(e.content,"scroll",e.events.scroll),h(e.content,"wheel",e.events.mousewheel),h(e.container,"mouseenter",e.events.mouseenter),h(n,"resize",e.events.debounce),h(o,"DOMContentLoaded",e.events.update),h(n,"load",e.events.update),e.initialised=!0}},w.scroll=function(e){this.updateScrollBars()},w.mousewheel=function(e){if(this.config.horizontalMouseScroll){e.preventDefault();var t=this,n=e.deltaY,o=Date.now(),s=function(){var e=Date.now()-o,i=b(e,0,8,400);e>400?cancelAnimationFrame(t.frame):(n<0?t.content.scrollLeft-=i:n>0&&(t.content.scrollLeft+=i),t.frame=g(s))};s()}},w.mouseenter=function(e){this.updateScrollBars()},w.mousedown=function(e){e.preventDefault(),this.down=!0;var t=this.config,n="progress"===t.barType?"tracks":"bars",s=e.target===this[n].x.node?"x":"y";this.currentAxis=s,this.update(),this.container.classList.add(t.visibleClass),this.container.classList.add(t.scrollingClass+"-"+s),"progress"===t.barType?(this.origin={x:e.pageX-this.tracks[s].x,y:e.pageY-this.tracks[s].y},this.mousemove(e)):this.origin={x:e.pageX-this.bars[s].x,y:e.pageY-this.bars[s].y},h(o,"mousemove",this.events.mousemove),h(o,"mouseup",this.events.mouseup)},w.mousemove=function(e){e.preventDefault();var t,n,o=this,s=this.origin,i=this.currentAxis,d=o.tracks[i],u=d[r[i]];"progress"===o.config.barType?(t=e[l[i]]-d[i],n=t/u*(o.content[c[i]]-o.rect[r[i]])):(t=e[l[i]]-s[i]-d[i],n=t/u*o[c[i]]),g(function(){o.content[a[i]]=n})},w.mouseup=function(e){var t=this.container.classList,n=this.config,s=this.events;t.toggle(n.visibleClass,n.alwaysShowBars),t.remove(n.scrollingClass+"-"+this.currentAxis),e.target.classList.contains(n.barClass)||(t.remove(n.hoverClass+"-x"),t.remove(n.hoverClass+"-y")),this.origin={},this.currentAxis=null,this.down=!1,f(o,"mousemove",s.mousemove),f(o,"mouseup",s.mouseup)},w.update=function(){var e=this,t=e.content;e.rect=v(e.container),e.scrollTop=t.scrollTop,e.scrollLeft=t.scrollLeft,e.scrollHeight=t.scrollHeight,e.scrollWidth=t.scrollWidth;var n=e.scrollWidth>e.rect.width&&!e.textarea,o=e.scrollHeight>e.rect.height;e.container.classList.toggle("mb-scroll-x",n),e.container.classList.toggle("mb-scroll-y",o),m(t,{overflow:"auto",marginBottom:n?-e.size:"",paddingBottom:n?e.size:"",marginRight:o?-e.size:"",paddingRight:o?e.size:""}),e.scrollX=n,e.scrollY=o,p(e.tracks,function(t,n){u(n,v(n.node)),u(e.bars[t],v(e.bars[t].node))}),e.updateScrollBars(),e.textarea&&!e.down&&t.selectionStart>=t.value.length&&(t.scrollTop=e.scrollHeight+1e3)},w.updateScrollBar=function(e){var t=this,n={},o=r,s=c,l=t.config,d=t.tracks[e][o[e]],u=t.rect[o[e]],h=t.content[a[e]],f=d/t[s[e]],p=h/(t[s[e]]-u);"progress"===l.barType?n[o[e]]=Math.floor(d*p):(n[o[e]]=Math.max(Math.floor(f*u),l.minBarSize),n[i[e]]=Math.floor((d-n[o[e]])*p)),g(function(){m(t.bars[e].node,n)})},w.updateScrollBars=function(){p(this.bars,function(e,t){this.updateScrollBar(e)},this)},w.destroy=function(){var e=this,t=this.container,o=t.classList;if(e.initialised){for(f(t,"mouseenter",e.events.mouseenter),f(n,"resize",e.events.debounce),o.remove(e.config.visibleClass),o.remove(e.config.containerClass);e.content.firstChild;)t.appendChild(e.content.firstChild);p(e.tracks,function(e,n){t.removeChild(n.node),o.remove("mb-scroll-"+e)}),t.removeChild(e.content),e.manualPosition&&(t.style.position="",null!==t.getAttribute("style")&&t.getAttribute("style").length||t.removeAttribute("style")),e.bars={x:{},y:{}},e.tracks={x:{},y:{}},e.content=null,e.initialised=!1}},e.MiniBar=C}(this);