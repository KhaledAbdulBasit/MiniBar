/*!
 * MiniBar 0.0.10
 * http://mobius.ovh/
 *
 * Released under the MIT license
 */
!function(t){"use strict";function e(t,e,s){var o;return function(){var i=this,n=arguments,r=function(){o=null,s||t.apply(i,n)},c=s&&!o;clearTimeout(o),o=setTimeout(r,e),c&&t.apply(i,n)}}var s={barType:"default",minBarSize:50,alwaysShowBars:!1,containerClass:"mb-container",contentClass:"mb-content",trackClass:"mb-track",barClass:"mb-bar",visibleClass:"mb-visible",progressClass:"mb-progress"},o=function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),o=1;o<arguments.length;o++){var i=arguments[o];if(null!=i)for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(s[n]=i[n])}return s},i=function(t,e,s){if("[object Object]"===Object.prototype.toString.call(t))for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.call(s,o,t[o]);else for(var i=0,n=t.length;i<n;i++)e.call(s,i,t[i])},n=function(t,e,s){t.addEventListener(e,s,!1)},r=function(t,e,s){t.removeEventListener(e,s)},c=function(t,e,s){var o=t&&t.style,n="[object Object]"===Object.prototype.toString.call(e);if(o){if(void 0===s&&!n)return s=window.getComputedStyle(t),void 0===e?s:s[e];n?i(e,function(t,e){t in o||(t="-webkit-"+t),o[t]=e+("string"==typeof e?"":"opacity"===t?"":"px")}):(e in o||(e="-webkit-"+e),o[e]=s+("string"==typeof s?"":"opacity"===e?"":"px"))}},a=function(t){var e=window,s=document,o=s.body,i=t.getBoundingClientRect(),n=void 0!==e.pageXOffset?e.pageXOffset:(s.documentElement||o.parentNode||o).scrollLeft,r=void 0!==e.pageYOffset?e.pageYOffset:(s.documentElement||o.parentNode||o).scrollTop;return{x:i.left+n,y:i.top+r,height:Math.round(i.height),width:Math.round(i.width)}},l=window.requestAnimationFrame||function(){var t=0;return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){var s,o=(new Date).getTime();return s=Math.max(0,16-(o-t)),t=o+s,setTimeout(function(){e(o+s)},s)}}(),h=function(){var t=0,e=document.createElement("div");return e.style.cssText="width: 100; height: 100; overflow: scroll; position: absolute; top: -9999;",document.body.appendChild(e),t=e.offsetWidth-e.clientWidth,document.body.removeChild(e),t},u=function(t,i){this.container=t,"string"==typeof content&&(this.container=document.querySelector(t)),this.config=o({},s,i),this.css=window.getComputedStyle(this.container),this.scrollbarSize=h(),this.bars={x:{},y:{}},this.tracks={x:{},y:{}},this.trackPos={x:"left",y:"top"},this.trackSize={x:"width",y:"height"},this.scrollPos={x:"scrollLeft",y:"scrollTop"},this.scrollSize={x:"scrollWidth",y:"scrollHeight"},this.offsetAxis={x:"offsetX",y:"offsetY"},this.mouseAxis={x:"pageX",y:"pageY"},this.events={update:this.update.bind(this),scroll:this.scroll.bind(this),mouseenter:this.mouseenter.bind(this),mousedown:this.mousedown.bind(this),mousemove:this.mousemove.bind(this),mouseup:this.mouseup.bind(this)},this.events.debounce=e(this.events.update,50),this.init()};u.prototype.init=function(){var t=this;for(t.container.classList.add(t.config.containerClass),t.content=document.createElement("div"),t.content.classList.add(t.config.contentClass),t.config.alwaysShowBars&&t.container.classList.add(t.config.visibleClass);t.container.firstChild;)t.content.appendChild(t.container.firstChild);i(t.tracks,function(e,s){t.bars[e].node=document.createElement("div"),s.node=document.createElement("div"),s.node.classList.add(t.config.trackClass,t.config.trackClass+"-"+e),t.bars[e].node.classList.add(t.config.barClass),s.node.appendChild(t.bars[e].node),t.container.appendChild(s.node),"progress"===t.config.barType?(s.node.classList.add(t.config.progressClass),n(s.node,"mousedown",t.events.mousedown)):n(t.bars[e].node,"mousedown",t.events.mousedown)}),t.container.appendChild(t.content),t.container.style.position="static"===t.css.position?"relative":t.css.position,t.update(),n(t.content,"scroll",t.events.scroll),n(t.container,"mouseenter",t.events.mouseenter),n(window,"resize",t.events.debounce),n(document,"DOMContentLoaded",t.events.update),n(window,"load",t.events.update)},u.prototype.scroll=function(){this.updateScrollBars()},u.prototype.mouseenter=function(){this.updateScrollBars()},u.prototype.mousedown=function(t){t.preventDefault();var e="progress"===this.config.barType?"tracks":"bars",s=t.target===this[e].x.node?"x":"y";this.currentAxis=s,this.update(),this.container.classList.add(this.config.visibleClass),this.origin={x:t.pageX-this.bars[s].x,y:t.pageY-this.bars[s].y},"progress"===this.config.barType&&(this.origin.x=t.pageX-this.tracks[s].x,this.origin.y=t.pageY-this.tracks[s].y,this.mousemove(t)),n(document,"mousemove",this.events.mousemove),n(document,"mouseup",this.events.mouseup)},u.prototype.mousemove=function(t){t.preventDefault();var e=this,s=this.origin,o=e.tracks[e.currentAxis],i=o[e.trackSize[e.currentAxis]],n=t[e.mouseAxis[e.currentAxis]]-s[e.currentAxis]-o[e.currentAxis],r=n/i,c=r*e[e.scrollSize[e.currentAxis]];"progress"===e.config.barType&&(n=t[e.mouseAxis[e.currentAxis]]-o[e.currentAxis],c=(r=n/i)*(e.content[e.scrollSize[e.currentAxis]]-i)),l(function(){e.content[e.scrollPos[e.currentAxis]]=c})},u.prototype.mouseup=function(){this.origin={},this.currentAxis=null,this.container.classList.toggle(this.config.visibleClass,this.config.alwaysShowBars),r(document,"mousemove",this.events.mousemove),r(document,"mouseup",this.events.mouseup)},u.prototype.update=function(){var t=this;i(this.tracks,function(e,s){o(s,a(s.node)),o(t.bars[e],a(t.bars[e].node))}),this.rect=a(this.container),this.scrollTop=this.content.scrollTop,this.scrollLeft=this.content.scrollLeft,this.scrollHeight=this.content.scrollHeight,this.scrollWidth=this.content.scrollWidth;var e=this.scrollWidth>this.rect.width,s=this.scrollHeight>this.rect.height;this.container.classList.toggle("mb-scroll-x",e),this.container.classList.toggle("mb-scroll-y",s),c(this.content,{overflow:"auto",marginBottom:e?-this.scrollbarSize:"",paddingBottom:e?this.scrollbarSize:"",marginRight:s?-this.scrollbarSize:"",paddingRight:s?this.scrollbarSize:""}),this.scrollX=e,this.scrollY=s,this.updateScrollBars()},u.prototype.updateScrollBar=function(t){var e=this,s={},o=this.tracks[t][this.trackSize[t]],i=this.content[this.scrollPos[t]],n=o/this[this.scrollSize[t]],r=i/(this[this.scrollSize[t]]-o);"default"===this.config.barType?(s[this.trackSize[t]]=Math.max(Math.floor(n*o),this.config.minBarSize),s[this.trackPos[t]]=Math.floor((o-s[this.trackSize[t]])*r)):"progress"===this.config.barType&&(s[this.trackSize[t]]=Math.floor(o*r)),l(function(){c(e.bars[t].node,s)})},u.prototype.updateScrollBars=function(){i(this.bars,function(t,e){this.updateScrollBar(t)},this)},u.prototype.destroy=function(){var t=this;for(i(t.tracks,function(e,s){r(t.bars[e].node,"mousedown",t.events.mousedown)}),r(t.content,"scroll",t.events.scroll),r(t.container,"mouseenter",t.events.mouseenter),r(window,"resize",t.events.debounce),t.container.classList.remove(t.config.containerClass);t.content.firstChild;)t.container.appendChild(t.content.firstChild);i(t.tracks,function(e,s){t.container.removeChild(s.node),t.container.classList.remove("mb-scroll-"+e)}),t.container.removeChild(t.content)},t.MiniBar=u}(this);
